{extend name="Base_template/base" /}

{block name="head_css_js"}
<style>
    .v-avatar{
        width: 32px;
        height: 32px;
    }


</style>
{/block}
{block name="header"}
{/block}
{block name="main-content"}
<div>
    <h1 class="h5 mx-1 my-4">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-dots" viewBox="0 0 16 16">
            <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
            <path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272 1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z"/>
        </svg>
        <span class="noticom">
            <a href="https://www.mgnav.com/sites/670.html#respond" class="link-dark" style="text-decoration: none;">暂无评论</a>
        </span>
    </h1>

    <div class="card">
        <div class="card-body">

            <form class="text-sm mb-4" id="comment_form">
                <div class="visitor-avatar d-flex flex-fill mb-2">
                    <img class="v-avatar rounded-circle" src="https://www.mgnav.com/wp-content/themes/webstackpro%20v2.0405/images/gravatar.jpg">
                </div>
                <div class="comment-textarea mb-3">
                    <textarea name="comment" class="form-control" placeholder="输入评论内容..." tabindex="4" cols="50" rows="3">
                    </textarea>
                </div>
                <div class="row row-sm">
                    <div class="col-sm-6 col-lg-4 mb-3">
                        <input type="text" name="author" class="form-control" value="" size="22" placeholder="昵称" tabindex="2">
                    </div>
                    <div class="col-sm-6 col-lg-4 mb-3">
                        <input type="text" name="email" class="form-control" value="" size="22" placeholder="邮箱" tabindex="3">
                    </div>
                    <div class="col-sm-12 col-lg-4 mb-3">
                        <input type="text" name="url" class="form-control" value="" size="22" placeholder="网址" tabindex="4">
                    </div>
                </div>
                <div class="com-footer text-end">
                    <input type="submit" class="btn btn-dark" name="submit" value="发表评论">
                </div>
            </form>
            <div class="not-comment card">
                <div class="card-body nothing text-center color-d">暂无评论...</div>
            </div>
        </div>
    </div>
</div>
{/block}


{block name="body_js"}

<script>
    $(function () {
        /**
         * 判断表单是否为空
         * @param obj
         * @returns {boolean}
         */
        function empty(data){
            if(!(data['comment'] && data['url'] && data['email'] && data["author"]))
                return false;
            return true;
        }
        // 设置form表单里面textarea标签的值为空
        $("#comment_form textarea").val("")

        $("#comment_form input[name='submit']").click(function (){
            data = {
                "comment": $("#comment_form textarea[name='comment']").val(),
                "url": $("#comment_form input[name='url']").val(),
                "email": $("#comment_form input[name='email']").val(),
                "author": $("#comment_form input[name='author']").val()
            }
            if(!empty(data)){
                // console.log(data)
                alert("错误");
                return false;
            }
            $.ajax( {
                url:'comment',
                data:data,
                type:'post',
                dataType:'json',
                success:function(data) {
                    console.log(data);

                },
                error : function(jqXHR, textStatus, errorThrown) {
                    alert(errorThrown);
                }
            });
        })
    });

</script>

{/block}